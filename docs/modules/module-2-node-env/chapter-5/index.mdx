# Chapter 5: Hello Server + เมนูร้าน

สร้างเว็บเซิร์ฟเวอร์ง่าย ๆ ด้วย `http` module ตอบข้อความและส่ง JSON เมนูจาก Module 1 พร้อมอธิบายคำสั่งที่ต้องใช้

## คำสั่งพื้นฐานที่ต้องใช้
- `http.createServer((req, res) => { ... })` สร้างเซิร์ฟเวอร์และรับ request ผ่าน callback
- `req.method`, `req.url` เช็กชนิดคำขอ (GET/POST/...) และเส้นทาง
- `res.writeHead(statusCode, headers)` ตั้งสถานะและ header (เช่น `Content-Type`)
- `res.end(body)` จบการตอบกลับและส่งข้อมูล
- `JSON.stringify(data)` แปลง object/array → JSON string ก่อนส่งกลับ
- `process.uptime()` เวลาที่เซิร์ฟเวอร์ทำงาน (วินาที) ใช้ใน `/status`
- `console.log(...)` ดูลำดับการเข้า route และ debug

## ชุดข้อมูลเมนู
```js
const menu = [
  { name: "Latte", price: 55 },
  { name: "Mocha", price: 65 },
  { name: "Ame", price: 45 }
];
```

## โค้ดตัวอย่าง
```js title="server.js"
import http from "http"; // โมดูลพื้นฐานของ Node สำหรับสร้างเซิร์ฟเวอร์

const menu = [
  { name: "Latte", price: 55 },
  { name: "Mocha", price: 65 },
  { name: "Ame", price: 45 }
];

// http.createServer รับ callback (req, res) เมื่อมี request เข้ามา
const server = http.createServer((req, res) => {
  // log ไว้เพื่อ debug ดูว่าเข้า route ไหน
  console.log(`${new Date().toISOString()} ${req.method} ${req.url}`);

  if (req.url === "/" && req.method === "GET") {
    res.writeHead(200, { "Content-Type": "text/plain" }); // ตั้ง status + header
    res.end("Welcome to My Café API"); // ส่งข้อความกลับ
    return;
  }

  if (req.url === "/about" && req.method === "GET") {
    res.writeHead(200, { "Content-Type": "text/plain" });
    res.end("About our café");
    return;
  }

  if (req.url === "/status" && req.method === "GET") {
    res.writeHead(200, { "Content-Type": "application/json" });
    res.end(
      JSON.stringify({
        status: "ok",
        menuCount: menu.length,
        uptime: process.uptime().toFixed(2) // เวลาเซิร์ฟเวอร์ทำงาน
      })
    );
    return;
  }

  if (req.url === "/menu" && req.method === "GET") {
    res.writeHead(200, { "Content-Type": "application/json" });
    res.end(JSON.stringify(menu)); // แปลง array → JSON string
    return;
  }

  // route อื่นไม่เจอ
  res.writeHead(404, { "Content-Type": "text/plain" });
  res.end("Not found");
});

// กำหนดพอร์ต มี fallback เป็น 3000
const PORT = process.env.PORT || 3000;
server.listen(PORT, () => {
  console.log(`Server running at http://localhost:${PORT}`);
});
```

### เช็กด้วย curl / browser
```sh
curl http://localhost:3000/
curl http://localhost:3000/about
curl http://localhost:3000/status
curl http://localhost:3000/menu
```
