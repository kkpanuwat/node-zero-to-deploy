---
id: day-1-javascript-loops
title: 'การวนซ้ำ (Loops)'
sidebar_label: Loops
description: ใช้ for และเพื่อน ๆ เพื่อสั่งคอมพิวเตอร์ทำงานซ้ำตามจำนวนรอบหรือเงื่อนไข
---

# การวนซ้ำ (Loops): สั่งให้ทำงานเดิม ๆ ไม่รู้เบื่อ

Loop คือเครื่องมือที่ทรงพลังที่สุดอย่างหนึ่งในการเขียนโปรแกรม มันช่วยให้เราสั่งคอมพิวเตอร์ให้ทำงานบางอย่างซ้ำ ๆ ตามจำนวนรอบหรือเงื่อนไขที่กำหนด โดยไม่ต้องเขียนโค้ดเดิมซ้ำ ๆ เอง ลองจินตนาการว่าเรากำลังดูแลร้านหนังสือ เราต้องวนเช็กสต็อก จัดชั้นหนังสือ และแจ้งลูกค้าหลายครั้งต่อวัน ด้านล่างนี้คือ Loop แบบที่ใช้บ่อย พร้อมตัวอย่างและโจทย์ฝึกที่ผูกโยงกับงานร้านหนังสือ

## `for` Loop: คุมจำนวนรอบได้เป๊ะ

`for` loop คือ Loop แบบคลาสสิกที่ใช้กันอย่างแพร่หลายที่สุด มีโครงสร้างที่ชัดเจน 3 ส่วน: (1) จุดเริ่มต้น (2) เงื่อนไขให้ทำต่อ (3) สิ่งที่ทำเมื่อจบรอบ ทำให้ควบคุมจำนวนรอบได้ตรงตามต้องการ

```javascript
// โครงสร้าง: for ( [จุดเริ่มต้น]; [เงื่อนไขให้ทำต่อ]; [สิ่งที่ทำเมื่อจบรอบ] )

for (let i = 1; i <= 5; i++) {
  console.log(`หยิบหนังสือโปรโมชั่นเล่มที่ ${i}`);
}
// ผลลัพธ์:
// หยิบหนังสือโปรโมชั่นเล่มที่ 1
// หยิบหนังสือโปรโมชั่นเล่มที่ 2
// ...
// หยิบหนังสือโปรโมชั่นเล่มที่ 5
```

Single `for` loop ยังสามารถซ้อนกัน (nested loop) เพื่อสร้าง pattern หรือคำนวณข้อมูลหลายมิติ ตัวอย่างด้านล่างใช้ `for` เพื่อสร้างตารางสูตรคูณ 1 ถึง 3

```javascript
for (let shelf = 1; shelf <= 3; shelf++) {
  let line = "";
  for (let row = 1; row <= 3; row++) {
    line += `ชั้น ${shelf}-แถว ${row} `;
  }
  console.log(line);
}
// ผลลัพธ์
// ชั้น 1-แถว 1 ชั้น 1-แถว 2 ชั้น 1-แถว 3 
// ชั้น 2-แถว 1 ชั้น 2-แถว 2 ชั้น 2-แถว 3 
// ชั้น 3-แถว 1 ชั้น 3-แถว 2 ชั้น 3-แถว 3 
```

เราสามารถใช้ `for` loop เพื่อวนอ่านค่าจาก Array ได้เช่นกัน:

```javascript
const bookCategories = ["Programming", "Science Fiction", "History"];

for (let i = 0; i < bookCategories.length; i++) {
  // i คือ index ที่เริ่มจาก 0
  // bookCategories[i] คือการเข้าถึงข้อมูลใน Array ณ ตำแหน่งนั้น
  console.log("หมวดหมู่: " + bookCategories[i]);
}
// ผลลัพธ์:
// หมวดหมู่: Programming
// หมวดหมู่: Science Fiction
// หมวดหมู่: History
```

**โจทย์ฝึก `for` loop**

1. ใช้ `for` เพื่อพิมพ์ข้อความ "ประกาศแนะนำหนังสือลำดับที่ X" ตั้งแต่ 1 ถึง 10
2. รับ Array ของยอดขายแต่ละวัน แล้วหายอดสูงสุดด้วยการใช้ `for`
3. (ท้าทาย) พิมพ์รหัสตำแหน่งชั้นหนังสือ เช่น `ชั้น 1-แถว A` ถึง `ชั้น 5-แถว E` ให้ออกมาเป็นกริดสวยงาม


### `while` Loop: วนซ้ำตราบเท่าที่เงื่อนไขเป็นจริง

`while` loop จะทำงานซ้ำ ๆ ตราบเท่าที่เงื่อนไขที่กำหนดเป็นจริง เหมาะสำหรับสถานการณ์ที่เราไม่รู้จำนวนรอบที่แน่นอนล่วงหน้า

```javascript
// โครงสร้าง: while (เงื่อนไข) { ... }

let boxCount = 0;
while (boxCount < 3) {
  console.log("ยกกล่องหนังสือใบที่ " + (boxCount + 1));
  boxCount++; // อย่าลืมเพิ่มค่าตัวแปรควบคุม เพื่อไม่ให้เกิด Infinite Loop!
}
// ผลลัพธ์:
// ยกกล่องหนังสือใบที่ 1
// ยกกล่องหนังสือใบที่ 2
// ยกกล่องหนังสือใบที่ 3
```

อีกตัวอย่างหนึ่งคือการลบงานออกจากคิวทีละรายการจนกว่าจะหมดคิว

```javascript
const shippingTasks = ["ห่อหนังสือ", "พิมพ์ใบปะหน้า", "เรียกขนส่ง"];

while (shippingTasks.length > 0) {
  const currentTask = shippingTasks.shift();
  console.log(`กำลังดำเนินการ: ${currentTask}`);
}
// ผลลัพธ์:
// กำลังดำเนินการ: ห่อหนังสือ
// กำลังดำเนินการ: พิมพ์ใบปะหน้า
// กำลังดำเนินการ: เรียกขนส่ง
```

**โจทย์ฝึก `while` loop**

1. สุ่มเลข 1-10 ต่อเนื่องจนได้เลข 5 เพื่อจำลองการค้นหาหนังสือรหัสพิเศษ แล้วแจ้งจำนวนครั้งที่ลองหยิบ
2. รับจำนวนหนังสือที่ต้องการจัดโปรโมชั่นและจำนวนที่ทำได้ต่อรอบ เพิ่มทีละ 5 เล่มด้วย `while` จนกว่าจะครบ พร้อมบอกจำนวนรอบที่ใช้

### `do...while` Loop: ทำก่อนถาม

`do...while` ทำงานอย่างน้อย 1 รอบเสมอ เพราะจะรันโค้ดใน `do { ... }` ก่อน แล้วค่อยตรวจสอบเงื่อนไขที่ท้ายรอบ เหมาะเมื่อเราต้องการให้โค้ดทำงานขั้นต่ำหนึ่งครั้ง เช่น ขอโค้ดยืนยันจากผู้ใช้

```javascript
let membershipCode = "";
const secretCode = "BOOK123";
let attempts = 0;

do {
  membershipCode = scanMembershipCard(); // สมมติฟังก์ชันนี้อ่านบัตรสมาชิก
  attempts++;
  console.log(`สแกนครั้งที่ ${attempts}`);
} while (membershipCode !== secretCode && attempts < 3);

if (membershipCode === secretCode) {
  console.log("ยืนยันสมาชิกพรีเมียมสำเร็จ");
} else {
  console.log("อ่านบัตรไม่สำเร็จ กรุณาติดต่อพนักงาน");
}
```

**โจทย์ฝึก `do...while` loop**

1. สุ่มหนังสือจากชั้น (เลข 1-6) อย่างน้อย 1 ครั้ง แล้วหมุนต่อจนเจอเลข 6 เพื่อจำลองการสุ่มเลือกหนังสือสุดพิเศษ
2. ใช้ `prompt` (ถ้ารันบนเบราว์เซอร์) เพื่อถามชื่อสมาชิกเรื่อย ๆ จนกว่าจะกรอกชื่อไม่ว่างเปล่า จึงให้ออกบัตรสะสมแต้ม

### `forEach` Method: สำหรับ Array โดยเฉพาะ

`forEach` เป็น Method ที่มีอยู่ใน Array โดยเฉพาะ ใช้สำหรับวนซ้ำสมาชิกแต่ละตัวใน Array และสามารถเข้าถึงค่า (value), ดัชนี (index) และตัว Array เองได้ เหมาะสำหรับการทำงานกับข้อมูลใน Array โดยตรง

```javascript
const staff = ["ใบหยก", "คีย์", "ไกด์"];

staff.forEach(function (name, index) {
  console.log(`พนักงานหมายเลข ${index + 1}: คุณ ${name}`);
});
// ผลลัพธ์:
// พนักงานหมายเลข 1: คุณ ใบหยก
// พนักงานหมายเลข 2: คุณ คีย์
// พนักงานหมายเลข 3: คุณ ไกด์
```

นอกจาก `for` แล้ว ยังมี Loop แบบอื่น ๆ เช่น `while` หรือ `forEach` (ที่เราได้เห็นในตัวอย่าง Lab) ซึ่งแต่ละแบบก็มีสไตล์การใช้งานที่เหมาะกับสถานการณ์ต่างกันไปครับ

เมธอด `forEach` ยังใช้ร่วมกับ Arrow Function และเงื่อนไขภายในได้ เช่นการรวมยอดที่มากกว่า 100

```javascript
const invoices = [120, 80, 450];
let total = 0;

invoices.forEach((amount) => {
  if (amount >= 100) {
    total += amount;
  }
});

console.log(`ยอดรวมที่ผ่านเกณฑ์: ${total}`);
```

**โจทย์ฝึก `forEach`**

1. รับ Array ของชื่อหนังสือที่ต้องจัดส่งแล้วพิมพ์เป็นประโยค เช่น `จัดส่ง: Clean Code`
2. รับ Array ของยอดใช้จ่ายสมาชิกแต่ละคนแล้วหาค่าเฉลี่ยด้วย `forEach`
